---
name: Core UI Components & Layout
status: open
created: 2025-10-24T13:37:39Z
updated: 2025-10-24T13:37:39Z
github: [Will be updated when synced to GitHub]
depends_on: [001, 002]
parallel: false
conflicts_with: []
---

# Task: Core UI Components & Layout

## Description

Build the foundational UI architecture including responsive layout system, client-side routing, reusable component library, and Warhammer-themed design system. Implement virtualized data tables for displaying 1000+ rows efficiently and create a theme system supporting dark/light modes with Warhammer Fantasy aesthetic.

This task creates the visual framework and navigation structure that all features will use.

## Acceptance Criteria

- [ ] Responsive layout working from 320px (mobile) to 2560px (desktop)
- [ ] Client-side hash-based routing with navigation between pages
- [ ] Header with search bar and navigation menu
- [ ] Collapsible sidebar with filters and category menu
- [ ] Virtualized data table component handles 1000+ rows smoothly (60fps)
- [ ] Theme system with dark and light modes (CSS custom properties)
- [ ] Warhammer Fantasy design system (colors, typography, icons)
- [ ] Toast notification system for user feedback
- [ ] Modal component for dialogs and confirmations
- [ ] Loading states and skeleton screens
- [ ] Mobile-first design with touch-optimized interactions
- [ ] No horizontal scroll on any screen size

## Technical Details

**Implementation Approach:**

1. **Layout System (`src/App.svelte`, `src/layouts/`):**
   ```svelte
   <!-- App.svelte -->
   <Router>
     <Layout>
       <Header />
       <Sidebar />
       <main>
         <slot />  <!-- Page content -->
       </main>
       <Footer />
     </Layout>
   </Router>
   ```

   - Use CSS Grid for main layout (header, sidebar, content, footer)
   - Flexbox for component-level layouts
   - Responsive breakpoints: 320px, 768px, 1024px, 1440px
   - Sidebar collapses to hamburger menu on mobile

2. **Routing (`src/lib/router.js` or use `svelte-spa-router`):**
   - Hash-based routing (works with file:// protocol)
   - Routes: `/`, `/browse/:category`, `/character/:id`, `/creator`, `/admin`, `/settings`
   - Lazy load page components (code splitting)
   - 404 fallback page
   - Browser history support (back/forward)

3. **Reusable Components (`src/components/`):**

   **DataTable.svelte** (virtualized list):
   - Use `svelte-virtual-list` or custom implementation
   - Row height: 48px (touch-friendly)
   - Render only visible rows + buffer (60-100 rows max)
   - Sorting by column (client-side)
   - Selection support (checkboxes)
   - Infinite scroll or pagination

   **SearchBar.svelte**:
   - Autocomplete dropdown with fuzzy search
   - Debounced input (300ms)
   - Keyboard navigation (arrow keys, enter, esc)
   - Recent searches (localStorage)
   - Clear button

   **Modal.svelte**:
   - Backdrop with click-to-close
   - Focus trap (accessibility)
   - ESC key to close
   - Sizes: small, medium, large, fullscreen

   **Toast.svelte**:
   - Auto-dismiss after 3-5 seconds
   - Types: success, error, warning, info
   - Stack multiple toasts
   - Pause on hover

   **ContextualHelp.svelte**:
   - Tooltip/popover for help text
   - Click or hover to reveal
   - Positioned intelligently (avoid screen edges)

4. **Design System (`src/styles/`):**

   **`theme.css`** (CSS custom properties):
   ```css
   :root {
     /* Dark theme (default) */
     --color-bg-primary: #1a1410;    /* Dark brown */
     --color-bg-secondary: #2a221a;
     --color-text-primary: #e8e0d5;  /* Parchment */
     --color-text-secondary: #b8a89a;
     --color-accent: #8b2e1f;        /* Blood red */
     --color-accent-hover: #a63728;

     /* Typography */
     --font-heading: 'Cinzel', serif;  /* Medieval style */
     --font-body: 'Merriweather', serif;
     --font-ui: 'Inter', sans-serif;

     /* Spacing */
     --spacing-xs: 0.25rem;
     --spacing-sm: 0.5rem;
     --spacing-md: 1rem;
     --spacing-lg: 1.5rem;
     --spacing-xl: 2rem;
   }

   [data-theme="light"] {
     --color-bg-primary: #f5f0e8;
     --color-bg-secondary: #e8dcc8;
     --color-text-primary: #2a221a;
     --color-text-secondary: #4a3f35;
     /* etc. */
   }
   ```

   **Icons:** Inline SVG sprites for common icons (chevron, search, menu, etc.)

5. **Responsive Design:**
   - Mobile-first CSS (base styles for mobile, media queries for desktop)
   - Touch targets: minimum 44x44px
   - Font scaling: clamp(14px, 2vw, 16px)
   - Images: responsive with max-width: 100%
   - No fixed pixel widths (use %, rem, vw)

6. **Performance Optimizations:**
   - Virtual scrolling for long lists
   - Lazy load images (if any)
   - Debounce/throttle scroll/resize handlers
   - Use `will-change` sparingly
   - Minimize re-renders with Svelte's reactivity

**Code Locations:**
- `src/App.svelte` - Root component
- `src/layouts/Layout.svelte` - Main layout wrapper
- `src/layouts/Header.svelte` - Top navigation
- `src/layouts/Sidebar.svelte` - Side menu
- `src/layouts/Footer.svelte` - Footer
- `src/lib/router.js` - Routing logic
- `src/components/DataTable.svelte` - Virtualized table
- `src/components/SearchBar.svelte` - Search component
- `src/components/Modal.svelte` - Modal dialog
- `src/components/Toast.svelte` - Notifications
- `src/components/ContextualHelp.svelte` - Tooltips
- `src/styles/theme.css` - Design tokens
- `src/styles/global.css` - Global styles

**Key Considerations:**
- Accessibility: ARIA labels, keyboard navigation, color contrast (WCAG AA)
- Performance: Virtual scrolling is critical for 1000+ item lists
- Mobile UX: Thumb-friendly navigation, no tiny tap targets
- Design: Balance thematic aesthetic with usability
- Fonts: Consider subsetting to reduce bundle size

## Dependencies

- [ ] Task 001 completed (project setup)
- [ ] Task 002 completed (data stores for components to consume)
- [ ] Fonts loaded (Google Fonts CDN or self-hosted)
- [ ] Icons prepared (SVG sprites)
- [ ] Install routing library: `npm install svelte-spa-router`
- [ ] Install virtual list: `npm install svelte-virtual-list` (optional)

## Effort Estimate

- Size: L (Large)
- Hours: 18-24 hours
- Parallel: false (depends on Tasks 001, 002)

**Breakdown:**
- Layout system and responsive design: 6h
- Routing implementation: 3h
- DataTable with virtualization: 5h
- Reusable components (SearchBar, Modal, Toast, etc.): 6h
- Design system and theming: 4h
- Accessibility and polish: 4h

## Definition of Done

- [ ] Layout responsive on all screen sizes (tested 320px to 2560px)
- [ ] Routing works with all planned routes
- [ ] DataTable smoothly scrolls 1000+ rows at 60fps
- [ ] Theme toggle switches between dark/light modes
- [ ] All components pass accessibility audit (Lighthouse > 90)
- [ ] No console warnings or errors
- [ ] Mobile navigation tested on real device (iOS/Android)
- [ ] Design reviewed and approved (by self or community)
- [ ] Component documentation in Storybook or similar (optional)
