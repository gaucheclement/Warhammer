---
epic: v2
status: completed
created: 2025-10-25T07:11:00Z
priority: high
depends_on: []
parallel: false
github: https://github.com/gaucheclement/Warhammer/issues/20
updated: 2025-10-25T05:44:31Z
started: 2025-10-25T05:27:02Z
completed: 2025-10-25T05:50:00Z
last_sync: 2025-10-25T05:44:31Z
---

# Database Import Integration

## Overview
Integrate the existing `extract-data.js` script into the build process to automatically import and update data from the Google Apps Script database.

## Current Situation
- Script `extract-data.js` exists and can fetch data from Google Apps Script
- Requires manual execution with web app URL
- Data is exported to `data/` directory as JSON files
- Application ID: `AKfycbwMRbK8i_M-os8c279diiKxeoze7JWJTKsLA511bTBJDkjxYY3GRE8tfWucuBOeh0x6Hg`

## Requirements

### 1. Build Integration
- Integrate `extract-data.js` into npm scripts
- Create `npm run extract` command that:
  - Uses the configured app ID
  - Fetches latest data from Google Sheets
  - Saves to `data/` directory
  - Validates data structure

### 2. Configuration
- Store app deployment URL in config file (`.env` or similar)
- Support different environments (dev, prod)
- Document required permissions/setup

### 3. Data Validation
- Verify all 23 data types are present
- Check data integrity (required fields)
- Report any missing or invalid data
- Log extraction statistics

### 4. Error Handling
- Handle network errors gracefully
- Retry logic for transient failures
- Clear error messages for users
- Fallback to cached data if fetch fails

## Technical Details

### Web App URL
```
https://script.google.com/macros/s/AKfycbwMRbK8i_M-os8c279diiKxeoze7JWJTKsLA511bTBJDkjxYY3GRE8tfWucuBOeh0x6Hg/exec
```

### Data Types (23 total)
- book, career, careerLevel, specie, class, talent
- characteristic, trapping, skill, spell, creature
- star, god, eye, hair, detail, trait
- lore, magick, etat, psychologie, quality, tree

### Output Files
- Individual files: `data/books.json`, `data/careers.json`, etc.
- Combined file: `data/all-data.json`

## Acceptance Criteria
- [ ] `npm run extract` successfully fetches data from Google Apps Script
- [ ] All 23 data types are extracted and saved
- [ ] Data validation reports any issues
- [ ] Clear error messages for common failure scenarios
- [ ] Documentation updated with setup instructions
- [ ] Can be integrated into build pipeline (`npm run build`)

## Dependencies
- None (can be implemented independently)

## Estimated Effort
2-3 hours

## Notes
- This script already exists and works manually
- Main work is integration and automation
- Should be part of the build process for v2
