---
name: Character Creation & Management
status: open
created: 2025-10-24T13:37:39Z
updated: 2025-10-24T14:01:23Z
github: https://github.com/gaucheclement/Warhammer/issues/5
depends_on: [3, 4]
parallel: true
conflicts_with: [6]
---

# Task: Character Creation & Management

## Description

Implement the complete character creation and management system including a multi-step wizard for creating characters (species → careers → characteristics → talents → equipment), character sheet views, character list with search/filter, and save/load/delete operations using IndexedDB. This is a core feature that provides significant user value.

## Acceptance Criteria

- [ ] Multi-step character creator wizard with 7 steps (species, careers, characteristics, talents, skills, spells, equipment)
- [ ] Each step validates input before allowing progression
- [ ] Character sheet view displays all character attributes clearly
- [ ] Character list page with search, filter, and sort capabilities
- [ ] Create, read, update, delete operations for characters
- [ ] Export character to JSON file
- [ ] Import character from JSON file with validation
- [ ] Random character generation option (one-click)
- [ ] Character advancement/leveling system
- [ ] Auto-save draft characters (prevent data loss)
- [ ] Character creation completes in < 5 minutes for experienced users

## Technical Details

**Implementation Approach:**

1. **Character Creator Wizard (`src/pages/CharacterCreator.svelte`):**

   **Step 1: Species Selection**
   - Display all species from `mergedData`
   - Show species details (characteristics modifiers, talents, etc.)
   - Select species → auto-populate base characteristics

   **Step 2: Career Selection**
   - Filter careers by species compatibility (if applicable)
   - Show career details (skills, talents, trappings)
   - Select initial career and level

   **Step 3: Characteristics**
   - Display base characteristics (M, WS, BS, S, T, I, Ag, Dex, Int, WP, Fel)
   - Apply species modifiers
   - Allow manual adjustment or random roll (2d10)
   - Validate ranges (typically 0-100)

   **Step 4: Skills**
   - Show career skills vs. available skills
   - Multi-select skills with advancement tracking
   - Calculate total advances

   **Step 5: Talents**
   - Career talents vs. available talents
   - Multi-select talents (check prerequisites)
   - Show talent descriptions on hover

   **Step 6: Spells (if applicable)**
   - Only show if career has spellcasting
   - Select spells from appropriate lore
   - Respect spell limits by career level

   **Step 7: Equipment & Trappings**
   - Show career trappings
   - Add custom equipment
   - Calculate encumbrance (if implemented)

   **Wizard UI:**
   - Progress indicator (1/7, 2/7, etc.)
   - Back/Next buttons
   - Save draft button (always visible)
   - Final review step before creation

2. **Character Data Model (`src/lib/characterModel.js`):**
   ```javascript
   {
     id: 'uuid-v4',
     name: 'Character Name',
     species: { id, name },
     career: { id, name, level },
     characteristics: { M, WS, BS, S, T, I, Ag, Dex, Int, WP, Fel },
     skills: [{ id, name, advances }],
     talents: [{ id, name, times }],
     spells: [{ id, name }],
     trappings: [{ id, name, quantity }],
     experience: { total, spent, available },
     notes: '',
     created: timestamp,
     updated: timestamp
   }
   ```

3. **Character Sheet (`src/pages/CharacterSheet.svelte`):**
   - Display all character data in readable format
   - Sections: Header (name, species, career), Characteristics, Skills, Talents, Spells, Equipment
   - Editable mode: Click to edit fields inline
   - Print-friendly CSS (for physical character sheets)
   - Export button (JSON download)

4. **Character List (`src/pages/CharacterList.svelte`):**
   - Grid/table view of all characters
   - Search by name
   - Filter by species, career
   - Sort by name, created date, updated date
   - Actions: View, Edit, Duplicate, Delete, Export
   - Confirm dialog before deletion

5. **Character Operations (`src/lib/characterOperations.js`):**
   - **Create:** Generate UUID, validate, save to IndexedDB
   - **Read:** Load by ID from IndexedDB
   - **Update:** Merge changes, update timestamp, save
   - **Delete:** Remove from IndexedDB (with confirmation)
   - **Export:** Serialize to JSON, trigger download
   - **Import:** Validate JSON schema, check ID conflicts, insert
   - **Random Generation:** Pick random values for all steps

6. **Auto-save & Draft Management:**
   - Save to localStorage every 30 seconds during character creation
   - Prompt to restore draft if found on page load
   - Clear draft after successful character save

7. **Character Advancement:**
   - XP tracking (total, spent, available)
   - Level up career (unlock new skills/talents)
   - Spend XP to improve characteristics
   - Career change system (if supported)

**Code Locations:**
- `src/pages/CharacterCreator.svelte` - Multi-step wizard
- `src/pages/CharacterSheet.svelte` - Display character details
- `src/pages/CharacterList.svelte` - List all characters
- `src/components/CharacterForm.svelte` - Reusable form components
- `src/lib/characterModel.js` - Data model and validation
- `src/lib/characterOperations.js` - CRUD operations
- `src/stores/characters.js` - Character state management

**Key Considerations:**
- UX: Make character creation intuitive (wizard pattern)
- Validation: Prevent invalid characters (missing required fields)
- Performance: Handle 100+ saved characters without slowdown
- Data loss prevention: Auto-save drafts, confirm before discard
- Mobile: Ensure forms are usable on small screens

## Dependencies

- [ ] Task 3 completed (data stores for species, careers, etc.)
- [ ] Task 4 completed (UI components for forms)
- [ ] UUID library: `npm install uuid`
- [ ] Form validation logic

## Effort Estimate

- Size: XL (Extra Large)
- Hours: 20-24 hours
- Parallel: true (can work alongside Task 6 - different code areas)

**Breakdown:**
- Character creator wizard (7 steps): 10h
- Character sheet view: 4h
- Character list with search/filter: 3h
- CRUD operations and IndexedDB integration: 3h
- Export/import functionality: 2h
- Random generation: 2h
- Auto-save and draft management: 2h
- Testing and bug fixes: 4h

## Definition of Done

- [ ] Character creation wizard completes all 7 steps without errors
- [ ] Created characters save to IndexedDB successfully
- [ ] Character sheet displays all attributes correctly
- [ ] Character list loads 100+ characters without lag
- [ ] Export/import works with valid JSON files
- [ ] Random generation creates valid characters
- [ ] Auto-save prevents data loss (tested by closing browser mid-creation)
- [ ] Mobile character creation tested on real device
- [ ] Unit tests for character operations (>70% coverage)
- [ ] Character creation time < 5 minutes (timed with real user)
